<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MediFlow ‚Äî Intelligent Hospital OS</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
/* MODERN GLASSMORPHISM UI - PREMIUM REDESIGN */
:root {
  --bg: #09090b;
  --surface: rgba(255, 255, 255, 0.03);
  --surface2: rgba(255, 255, 255, 0.06);
  --surface3: rgba(255, 255, 255, 0.09);
  --border: rgba(255, 255, 255, 0.08);
  --border-bright: rgba(255, 255, 255, 0.15);
  
  /* Vibrant Gradients */
  --cyan: #06b6d4;
  --blue: #3b82f6;
  --violet: #8b5cf6;
  --pink: #ec4899;
  --green: #10b981;
  --amber: #f59e0b;
  --red: #ef4444;

  --text: #ffffff;
  --text-dim: #a1a1aa;
  --text-muted: #52525b;

  --font-display: 'Outfit', system-ui, sans-serif;
  --font-body: 'Plus Jakarta Sans', system-ui, sans-serif;
  --font-mono: 'JetBrains Mono', monospace;

  --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.4);
  --glass-blur: blur(20px);
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html { scroll-behavior: smooth; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-body);
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
  -webkit-font-smoothing: antialiased;
}

/* Premium Animated Background */
body::before {
  content: '';
  position: fixed; inset: -50%;
  width: 200%; height: 200%;
  background: 
    radial-gradient(circle at 10% 40%, rgba(139, 92, 246, 0.15) 0%, transparent 40%),
    radial-gradient(circle at 90% 20%, rgba(6, 182, 212, 0.15) 0%, transparent 40%),
    radial-gradient(circle at 50% 80%, rgba(236, 72, 153, 0.1) 0%, transparent 40%);
  z-index: -1;
  animation: breathe 20s ease-in-out infinite alternate;
  pointer-events: none;
}
@keyframes breathe {
  0% { transform: scale(1) rotate(0deg); }
  100% { transform: scale(1.05) rotate(2deg); }
}

/* === LOGIN SCREEN === */
#loginScreen {
  position: fixed; inset: 0;
  display: flex; align-items: center; justify-content: center;
  z-index: 1000;
  background: rgba(9, 9, 11, 0.8);
  backdrop-filter: var(--glass-blur);
}
.login-container {
  width: 480px; max-width: 92vw;
  background: rgba(20, 20, 25, 0.6);
  backdrop-filter: blur(30px);
  border: 1px solid var(--border-bright);
  border-radius: 28px;
  padding: 48px 40px;
  box-shadow: 0 30px 60px rgba(0,0,0,0.5), inset 0 1px 1px rgba(255,255,255,0.1);
  position: relative;
  animation: popIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) both;
}
.login-logo {
  display: flex; align-items: center; gap: 16px; margin-bottom: 40px;
}
.login-logo-icon {
  width: 56px; height: 56px;
  background: linear-gradient(135deg, var(--cyan), var(--violet));
  border-radius: 16px;
  display: flex; align-items: center; justify-content: center;
  font-size: 28px;
  box-shadow: 0 12px 30px rgba(139, 92, 246, 0.4);
}
.login-logo h1 {
  font-family: var(--font-display); font-size: 32px; font-weight: 800; letter-spacing: -1px;
}
.login-logo h1 span {
  background: linear-gradient(to right, var(--cyan), var(--violet));
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.login-logo p {
  font-size: 11px; color: var(--text-dim); font-family: var(--font-mono); letter-spacing: 0.5px;
}
.login-label {
  font-size: 11px; font-family: var(--font-mono); color: var(--text-dim);
  text-transform: uppercase; margin-bottom: 10px; font-weight: 600;
}
.login-field {
  width: 100%;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px;
  color: var(--text);
  font-family: var(--font-body); font-size: 15px;
  outline: none; transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  margin-bottom: 24px;
}
.login-field:focus {
  border-color: var(--cyan); background: rgba(255,255,255,0.05);
  box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.15);
}
.role-grid {
  display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 32px;
}
.role-btn {
  padding: 16px; border-radius: 14px;
  background: var(--surface); border: 1px solid var(--border);
  color: var(--text-dim); font-family: var(--font-body); font-size: 14px; font-weight: 600;
  cursor: pointer; transition: all 0.3s; text-align: center;
  display: flex; flex-direction: column; align-items: center; gap: 8px;
}
.role-btn:hover { border-color: var(--border-bright); background: var(--surface2); color: var(--text); }
.role-btn.active {
  border-color: var(--cyan);
  background: linear-gradient(135deg, rgba(6,182,212,0.1), rgba(139,92,246,0.1));
  color: #fff;
  box-shadow: 0 0 20px rgba(6, 182, 212, 0.2);
}
.role-btn .role-icon { font-size: 24px; }
.login-btn {
  width: 100%; padding: 18px;
  background: linear-gradient(135deg, var(--cyan), var(--blue));
  border: none; border-radius: 14px;
  color: #ffffff; font-family: var(--font-display); font-weight: 700; font-size: 16px;
  cursor: pointer; transition: all 0.3s;
  box-shadow: 0 10px 25px rgba(6, 182, 212, 0.4);
}
.login-btn:hover { transform: translateY(-2px); box-shadow: 0 15px 35px rgba(6, 182, 212, 0.5); }
.login-btn:active { transform: translateY(1px); }

/* === MAIN APP === */
#app { display: none; position: relative; z-index: 1; min-height: 100vh; }

/* NAVBAR */
nav {
  position: fixed; top: 0; left: 0; right: 0; height: 80px;
  background: rgba(9, 9, 11, 0.7); backdrop-filter: var(--glass-blur);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 40px; z-index: 500;
}
.nav-logo {
  display: flex; align-items: center; gap: 12px;
  font-family: var(--font-display); font-weight: 800; font-size: 24px; letter-spacing: -0.5px;
}
.nav-logo-icon {
  width: 40px; height: 40px;
  background: linear-gradient(135deg, var(--cyan), var(--violet));
  border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 18px;
  box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
}
.nav-logo span { background: linear-gradient(to right, var(--cyan), var(--violet)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.nav-tabs { display: flex; gap: 8px; }
.nav-tab {
  padding: 10px 20px; border-radius: 12px; background: transparent; border: 1px solid transparent;
  color: var(--text-dim); font-family: var(--font-body); font-size: 14px; font-weight: 600;
  cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px;
}
.nav-tab:hover { background: var(--surface2); color: var(--text); }
.nav-tab.active {
  background: var(--surface2); border-color: var(--border-bright); color: #fff;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.nav-right { display: flex; align-items: center; gap: 20px; }
.user-badge {
  display: flex; align-items: center; gap: 10px;
  background: var(--surface2); border: 1px solid var(--border);
  border-radius: 24px; padding: 8px 16px;
  font-size: 12px; font-family: var(--font-mono); color: var(--cyan); font-weight: 600;
}
.live-dot {
  width: 8px; height: 8px; border-radius: 50%; background: var(--green);
  box-shadow: 0 0 10px var(--green); animation: pulse 2s infinite;
}
.logout-btn {
  padding: 10px 20px; border-radius: 12px;
  background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.2);
  color: var(--red); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s;
}
.logout-btn:hover { background: rgba(239, 68, 68, 0.2); box-shadow: 0 4px 15px rgba(239, 68, 68, 0.2); }

/* PAGES */
.page {
  display: none; padding: 120px 40px 60px;
  max-width: 1500px; margin: 0 auto;
  animation: fadeSlideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) both;
}
.page.active { display: block; }
.page-header { margin-bottom: 40px; }
.page-header h2 {
  font-family: var(--font-display); font-size: 42px; font-weight: 800; letter-spacing: -1.5px;
  margin-bottom: 12px;
}
.page-header h2 span { background: linear-gradient(135deg, var(--cyan), var(--blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.page-header p { color: var(--text-dim); font-size: 16px; font-weight: 500; }
.breadcrumb {
  display: flex; align-items: center; gap: 10px;
  font-family: var(--font-mono); font-size: 12px; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase; letter-spacing: 1px;
}
.breadcrumb span:last-child { color: var(--cyan); }

/* STATS ROW */
.stats-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; margin-bottom: 40px; }
.stat-card {
  background: var(--surface); backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border); border-radius: 20px; padding: 28px;
  position: relative; overflow: hidden; transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
.stat-card:hover { border-color: var(--border-bright); transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.3); }
.stat-card::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px;
}
.stat-card.c1::before { background: linear-gradient(90deg, var(--cyan), var(--blue)); }
.stat-card.c2::before { background: linear-gradient(90deg, var(--violet), var(--pink)); }
.stat-card.c3::before { background: linear-gradient(90deg, var(--amber), var(--red)); }
.stat-card.c4::before { background: linear-gradient(90deg, var(--green), var(--cyan)); }
.stat-num { font-family: var(--font-display); font-size: 48px; font-weight: 800; margin-bottom: 8px; line-height: 1; }
.stat-label { font-size: 13px; color: var(--text-dim); font-weight: 600; text-transform: uppercase; letter-spacing: 1.5px; }

/* FORM STYLES */
.form-card {
  background: var(--surface); backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border); border-radius: 24px; padding: 40px;
  position: relative; overflow: hidden;
}
.form-card::before {
  content:''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
}
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
.form-group { display: flex; flex-direction: column; gap: 10px; }
.form-group.full { grid-column: 1 / -1; }
.form-group label {
  font-size: 12px; font-family: var(--font-mono); color: var(--text-dim);
  letter-spacing: 1px; text-transform: uppercase; font-weight: 600;
}
.form-input, .form-select, .form-textarea {
  background: rgba(255,255,255,0.03); border: 1px solid var(--border);
  border-radius: 12px; padding: 16px; color: var(--text);
  font-family: var(--font-body); font-size: 15px; outline: none; transition: all 0.3s; width: 100%;
}
.form-input:focus, .form-select:focus, .form-textarea:focus {
  border-color: var(--cyan); background: rgba(255,255,255,0.05); box-shadow: 0 0 0 4px rgba(6, 182, 212, 0.1);
}
.form-select option { background: #18181b; }
.form-textarea { resize: vertical; min-height: 120px; }
.ai-suggestion {
  background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3);
  border-radius: 12px; padding: 14px 18px; font-size: 13px; color: #c4b5fd;
  display: flex; align-items: center; gap: 12px; margin-top: 8px; font-family: var(--font-mono);
  box-shadow: 0 4px 15px rgba(139, 92, 246, 0.15);
}
.submit-btn {
  padding: 18px 40px; background: linear-gradient(135deg, var(--cyan), var(--blue));
  border: none; border-radius: 14px; color: #ffffff;
  font-family: var(--font-display); font-weight: 700; font-size: 16px;
  cursor: pointer; transition: all 0.3s; margin-top: 16px;
  box-shadow: 0 10px 25px rgba(6, 182, 212, 0.3);
}
.submit-btn:hover { transform: translateY(-2px); box-shadow: 0 15px 35px rgba(6, 182, 212, 0.4); }

/* PRIORITY BADGES */
.badge {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 6px 14px; border-radius: 24px;
  font-size: 12px; font-family: var(--font-mono); font-weight: 600; letter-spacing: 0.5px;
}
.badge-critical { background: rgba(239, 68, 68, 0.15); color: #fca5a5; border: 1px solid rgba(239, 68, 68, 0.4); box-shadow: 0 0 15px rgba(239,68,68,0.2); }
.badge-high { background: rgba(245, 158, 11, 0.15); color: #fcd34d; border: 1px solid rgba(245, 158, 11, 0.4); box-shadow: 0 0 15px rgba(245,158,11,0.2); }
.badge-medium { background: rgba(14, 165, 233, 0.15); color: #7dd3fc; border: 1px solid rgba(14, 165, 233, 0.4); }
.badge-low { background: rgba(16, 185, 129, 0.15); color: #6ee7b7; border: 1px solid rgba(16, 185, 129, 0.4); }
.badge-waiting { background: rgba(161, 161, 170, 0.15); color: #d4d4d8; border: 1px solid rgba(161, 161, 170, 0.3); }
.badge-inprogress { background: rgba(139, 92, 246, 0.15); color: #c4b5fd; border: 1px solid rgba(139, 92, 246, 0.4); }
.badge-lab { background: rgba(236, 72, 153, 0.15); color: #f9a8d4; border: 1px solid rgba(236, 72, 153, 0.4); }
.badge-done { background: rgba(16, 185, 129, 0.15); color: #6ee7b7; border: 1px solid rgba(16, 185, 129, 0.4); }

/* CARDS GRID */
.cards-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 28px; }
.patient-card {
  background: var(--surface); backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border); border-radius: 20px; overflow: hidden;
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1); position: relative;
}
.patient-card:hover { border-color: var(--border-bright); transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
.card-header {
  padding: 24px; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: flex-start;
  background: rgba(255,255,255,0.02);
}
.card-header-left { display: flex; gap: 16px; align-items: center; }
.card-avatar {
  width: 52px; height: 52px; border-radius: 16px;
  background: linear-gradient(135deg, rgba(6,182,212,0.2), rgba(139,92,246,0.2));
  border: 1px solid rgba(255,255,255,0.1);
  display: flex; align-items: center; justify-content: center; font-size: 24px;
}
.card-name { font-family: var(--font-display); font-size: 20px; font-weight: 700; margin-bottom: 4px; }
.card-meta { font-size: 13px; color: var(--text-dim); font-family: var(--font-mono); }
.card-body { padding: 24px; }
.card-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
.card-label { font-size: 12px; font-family: var(--font-mono); color: var(--text-muted); letter-spacing: 1px; text-transform: uppercase; font-weight: 600; }
.card-value { font-size: 14px; font-weight: 500; }
.card-symptoms {
  background: rgba(255,255,255,0.03); border: 1px solid var(--border);
  border-radius: 12px; padding: 16px; font-size: 14px; color: var(--text-dim);
  margin-bottom: 20px; line-height: 1.6;
}
.card-footer { padding: 0 24px 24px; display: flex; flex-direction: column; gap: 16px; }

/* TOGGLE */
.toggle-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; }
.toggle-label { font-size: 14px; font-weight: 600; color: var(--text-dim); }
.toggle { position: relative; display: inline-block; width: 50px; height: 26px; }
.toggle input { opacity: 0; width: 0; height: 0; }
.toggle-slider {
  position: absolute; inset: 0; background: rgba(255,255,255,0.1);
  border-radius: 26px; cursor: pointer; transition: 0.3s;
}
.toggle-slider::before {
  content: ''; position: absolute; height: 18px; width: 18px; left: 4px; bottom: 4px;
  background: #fff; border-radius: 50%; transition: 0.3s;
}
input:checked + .toggle-slider { background: var(--cyan); box-shadow: 0 0 15px rgba(6,182,212,0.4); }
input:checked + .toggle-slider::before { transform: translateX(24px); }

.action-btn {
  width: 100%; padding: 16px; border: none; border-radius: 12px;
  background: linear-gradient(135deg, var(--cyan), var(--blue));
  color: #fff; font-family: var(--font-display); font-weight: 700; font-size: 15px;
  cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 15px rgba(6,182,212,0.3);
}
.action-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(6,182,212,0.4); }

/* EMPTY STATE */
.empty-state {
  text-align: center; padding: 100px 40px;
  border: 1px dashed var(--border-bright); border-radius: 24px;
  background: var(--surface); backdrop-filter: var(--glass-blur);
}
.empty-state .icon { font-size: 56px; margin-bottom: 20px; filter: drop-shadow(0 0 20px rgba(255,255,255,0.2)); }
.empty-state h3 { font-family: var(--font-display); font-size: 24px; margin-bottom: 12px; }
.empty-state p { color: var(--text-dim); font-size: 15px; }

/* SEARCH TOOLBAR */
.toolbar { display: flex; gap: 16px; margin-bottom: 32px; flex-wrap: wrap; }
.search-box {
  display: flex; align-items: center; gap: 12px;
  background: var(--surface); backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border); border-radius: 14px; padding: 12px 20px; flex: 1; min-width: 250px;
}
.search-box input {
  background: transparent; border: none; outline: none;
  color: var(--text); font-family: var(--font-body); font-size: 15px; flex: 1;
}
.filter-btn {
  padding: 12px 24px; border-radius: 14px;
  background: var(--surface); border: 1px solid var(--border);
  color: var(--text-dim); font-size: 14px; font-weight: 600; cursor: pointer;
  font-family: var(--font-body); transition: all 0.3s; white-space: nowrap;
}
.filter-btn:hover { background: var(--surface2); }
.filter-btn.active { background: var(--surface3); border-color: var(--cyan); color: #fff; box-shadow: 0 0 20px rgba(6,182,212,0.15); }

/* TIMELINE OVERRIDES */
.timeline-item {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 20px; overflow: hidden; margin-bottom: 16px;
  backdrop-filter: var(--glass-blur);
}
.timeline-header { padding: 20px 24px; }
.journey-dot {
  width: 40px; height: 40px; border-radius: 50%;
  background: rgba(255,255,255,0.05); border: 2px solid var(--border);
  font-size: 18px;
}
.journey-step.done .journey-dot {
  background: rgba(6,182,212,0.2); border-color: var(--cyan); box-shadow: 0 0 20px rgba(6,182,212,0.4);
}
.journey-step.current .journey-dot {
  background: rgba(245,158,11,0.2); border-color: var(--amber); box-shadow: 0 0 20px rgba(245,158,11,0.4);
}
/* KANBAN */
.kanban-col {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 20px; padding: 20px; backdrop-filter: var(--glass-blur);
}
.kanban-card { background: rgba(255,255,255,0.04); border: 1px solid var(--border); border-radius: 12px; padding: 16px; }

/* TOASTS */
.toast {
  background: rgba(20,20,25,0.9); backdrop-filter: blur(20px);
  border: 1px solid var(--border-bright); border-radius: 16px;
  padding: 16px 24px; font-size: 14px; font-weight: 600;
  box-shadow: 0 15px 40px rgba(0,0,0,0.5);
  display: flex; gap: 12px; align-items: center;
}

/* CARDS SPECIFIC */
.pharma-card {
  background: var(--surface); backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border); border-radius: 24px; padding: 32px;
}
.dispensed-btn {
  margin-top: 24px; width: 100%; padding: 16px;
  background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3);
  border-radius: 12px; color: #34d399; font-size: 15px; font-weight: 700; cursor: pointer;
  transition: all 0.3s;
}
.dispensed-btn:hover { background: rgba(16, 185, 129, 0.25); box-shadow: 0 4px 15px rgba(16,185,129,0.2); }

@keyframes popIn {
  from { opacity: 0; transform: scale(0.95) translateY(20px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}
@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes pulse {
  0%,100% { opacity: 1; box-shadow: 0 0 10px var(--green); }
  50% { opacity: 0.5; box-shadow: 0 0 2px var(--green); }
}
@keyframes toastIn { from { opacity: 0; transform: translateX(40px); } to { opacity: 1; transform: translateX(0); } }
@keyframes toastOut { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(40px); } }

/* Scrollbar */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.3); }
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen">
  <div class="login-container">
    <div class="login-logo">
      <div class="login-logo-icon">‚öïÔ∏è</div>
      <div>
        <h1>Medi<span>Flow</span></h1>
        <p>INTELLIGENT HOSPITAL OPERATING SYSTEM</p>
      </div>
    </div>
    <div class="form-group" style="margin-bottom:24px;">
      <div class="login-label">Select Your Role</div>
      <div class="role-grid">
        <div class="role-btn active" data-role="reception" onclick="selectRole(this)">
          <span class="role-icon">üè•</span>Reception
        </div>
        <div class="role-btn" data-role="doctor" onclick="selectRole(this)">
          <span class="role-icon">üë®‚Äç‚öïÔ∏è</span>Doctor
        </div>
        <div class="role-btn" data-role="lab" onclick="selectRole(this)">
          <span class="role-icon">üî¨</span>Lab
        </div>
        <div class="role-btn" data-role="medical" onclick="selectRole(this)">
          <span class="role-icon">üíä</span>Medical
        </div>
      </div>
    </div>
    <div class="form-group" style="margin-bottom:16px;">
      <div class="login-label">Username</div>
      <input class="login-field" type="text" id="loginUser" placeholder="Enter username..." value="admin">
    </div>
    <div class="form-group" style="margin-bottom:28px;">
      <div class="login-label">Password</div>
      <input class="login-field" type="password" id="loginPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" value="password">
    </div>
    <button class="login-btn" onclick="doLogin()">‚ö° Access System</button>
  </div>
</div>

<!-- MAIN APP -->
<div id="app">
  <!-- NAVBAR -->
  <nav>
    <div class="nav-logo">
      <div class="nav-logo-icon">‚öïÔ∏è</div>
      Medi<span>Flow</span>
    </div>
    <div class="nav-tabs" id="navTabs">
      <button class="nav-tab active" onclick="showPage('reception')" data-page="reception">
        <span class="tab-icon">üè•</span>Reception
      </button>
      <button class="nav-tab" onclick="showPage('doctor')" data-page="doctor">
        <span class="tab-icon">üë®‚Äç‚öïÔ∏è</span>Doctor
      </button>
      <button class="nav-tab" onclick="showPage('lab')" data-page="lab">
        <span class="tab-icon">üî¨</span>Lab
      </button>
      <button class="nav-tab" onclick="showPage('medical')" data-page="medical">
        <span class="tab-icon">üíä</span>Medical
      </button>
      <button class="nav-tab" onclick="showPage('tracking')" data-page="tracking">
        <span class="tab-icon">üì°</span>Tracking
      </button>
    </div>
    <div class="nav-right">
      <div class="user-badge">
        <div class="live-dot"></div>
        <span id="userBadge">RECEPTION</span>
      </div>
      <button class="logout-btn" onclick="doLogout()">‚Ü© Logout</button>
    </div>
  </nav>

  <!-- TOAST CONTAINER -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- ==================== RECEPTION PAGE ==================== -->
  <div class="page active" id="page-reception">
    <div class="page-header">
      <div class="breadcrumb"><span>MediFlow</span><span>‚Ä∫</span><span>Reception</span></div>
      <h2>Patient <span>Intake</span></h2>
      <p>Register and triage incoming patients with AI-assisted priority scoring.</p>
    </div>

    <div class="stats-row" id="receptionStats">
      <div class="stat-card c1"><div class="stat-num" id="st-total">0</div><div class="stat-label">Total Patients</div></div>
      <div class="stat-card c2"><div class="stat-num" id="st-waiting">0</div><div class="stat-label">Awaiting Doctor</div></div>
      <div class="stat-card c3"><div class="stat-num" id="st-critical">0</div><div class="stat-label">Critical Cases</div></div>
      <div class="stat-card c4"><div class="stat-num" id="st-done">0</div><div class="stat-label">Discharged Today</div></div>
    </div>

    <div class="form-card">
      <h3 style="font-family:var(--font-display);font-size:20px;font-weight:700;margin-bottom:24px;">
        üÜï New Patient Registration
      </h3>
      <div class="form-grid">
        <div class="form-group">
          <label>Patient Name</label>
          <input class="form-input" type="text" id="f-name" placeholder="Full name...">
        </div>
        <div class="form-group">
          <label>Age</label>
          <input class="form-input" type="number" id="f-age" placeholder="Years..." min="0" max="150">
        </div>
        <div class="form-group full">
          <label>Symptoms</label>
          <textarea class="form-textarea" id="f-symptoms" placeholder="Describe symptoms in detail..."></textarea>
          <div class="ai-suggestion" id="aiSuggestion" style="display:none;">
            <span>ü§ñ</span><span id="aiSuggestionText"></span>
          </div>
        </div>
        <div class="form-group">
          <label>Priority Level</label>
          <select class="form-select" id="f-priority">
            <option value="">‚Äî Select Priority ‚Äî</option>
            <option value="Critical">üî¥ Critical</option>
            <option value="High">üü† High</option>
            <option value="Medium">üîµ Medium</option>
            <option value="Low">üü¢ Low</option>
          </select>
        </div>
        <div class="form-group">
          <label>Assigned Doctor</label>
          <select class="form-select" id="f-doctor">
            <option value="Dr. Sharma">Dr. Sharma (General)</option>
            <option value="Dr. Patel">Dr. Patel (Cardiology)</option>
            <option value="Dr. Rao">Dr. Rao (Neuro)</option>
            <option value="Dr. Singh">Dr. Singh (Ortho)</option>
          </select>
        </div>
        <div class="form-group full">
          <button class="submit-btn" onclick="submitPatient()">‚ö° Register Patient & Triage</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== DOCTOR PAGE ==================== -->
  <div class="page" id="page-doctor">
    <div class="page-header">
      <div class="breadcrumb"><span>MediFlow</span>‚Ä∫<span>Doctor</span></div>
      <h2>Doctor <span>Console</span></h2>
      <p>Review patient cases, add notes, and manage prescriptions.</p>
    </div>
    <div class="toolbar">
      <div class="search-box">
        <span>üîç</span>
        <input type="text" id="doctorSearch" placeholder="Search patients..." oninput="renderDoctorCards()">
      </div>
      <button class="filter-btn active" onclick="setDoctorFilter('all',this)">All</button>
      <button class="filter-btn" onclick="setDoctorFilter('Critical',this)">üî¥ Critical</button>
      <button class="filter-btn" onclick="setDoctorFilter('High',this)">üü† High</button>
      <button class="filter-btn" onclick="setDoctorFilter('Medium',this)">üîµ Medium</button>
    </div>
    <div class="cards-grid" id="doctorCards"></div>
  </div>

  <!-- ==================== LAB PAGE ==================== -->
  <div class="page" id="page-lab">
    <div class="page-header">
      <div class="breadcrumb"><span>MediFlow</span>‚Ä∫<span>Lab</span></div>
      <h2>Lab <span>Results</span></h2>
      <p>Process test requests and submit diagnostic results.</p>
    </div>
    <div class="cards-grid" id="labCards"></div>
  </div>

  <!-- ==================== MEDICAL PAGE ==================== -->
  <div class="page" id="page-medical">
    <div class="page-header">
      <div class="breadcrumb"><span>MediFlow</span>‚Ä∫<span>Medical</span></div>
      <h2>Pharmacy <span>Dispatch</span></h2>
      <p>Verify and dispense prescriptions for verified patients.</p>
    </div>
    <div class="cards-grid" id="medicalCards"></div>
  </div>

  <!-- ==================== TRACKING PAGE ==================== -->
  <div class="page" id="page-tracking">
    <div class="page-header">
      <div class="breadcrumb"><span>MediFlow</span>‚Ä∫<span>Tracking</span></div>
      <h2>Live <span>Tracking</span></h2>
      <p>Real-time patient journey monitoring, analytics, and workflow board.</p>
    </div>

    <!-- Mini stats -->
    <div class="stats-row" id="trackingStats">
      <div class="stat-card c1"><div class="stat-num" id="tr-total">0</div><div class="stat-label">Total Today</div></div>
      <div class="stat-card c2"><div class="stat-num" id="tr-active">0</div><div class="stat-label">Active Cases</div></div>
      <div class="stat-card c3"><div class="stat-num" id="tr-lab">0</div><div class="stat-label">In Lab</div></div>
      <div class="stat-card c4"><div class="stat-num" id="tr-complete">0</div><div class="stat-label">Completed</div></div>
    </div>

    <!-- Kanban Board -->
    <div class="chart-title" style="font-family:var(--font-display);font-size:20px;font-weight:700;margin-bottom:16px;">
      üìã Workflow Board
    </div>
    <div class="kanban" id="kanbanBoard"></div>

    <!-- Chart -->
    <div class="chart-area">
      <div class="chart-title">
        üìä Patient Volume ‚Äî Last 7 Days
        <span style="font-size:12px;color:var(--text-dim);font-family:var(--font-mono);">LIVE</span>
      </div>
      <div class="bar-chart" id="barChart"></div>
    </div>

    <!-- Timeline -->
    <div class="chart-title" style="font-family:var(--font-display);font-size:20px;font-weight:700;margin-bottom:16px;">
      üîÑ Patient Journey Timeline
    </div>
    <div class="timeline-container" id="timelineContainer"></div>
  </div>

</div><!-- end #app -->

<script>
// ==================== STATE ====================
let patients = [];
let currentRole = 'reception';
let doctorFilter = 'all';
let patientIdCounter = 1000;

const ROLES = {
  reception: {pages:['reception','tracking'], label:'RECEPTION'},
  doctor: {pages:['doctor','tracking'], label:'DR. SYSTEM'},
  lab: {pages:['lab','tracking'], label:'LAB TECH'},
  medical: {pages:['medical','tracking'], label:'PHARMACY'},
};

// Pre-populate demo patients
const demoPatients = [
  {id:1001,name:'Arun Krishnan',age:45,symptoms:'Chest pain, shortness of breath, sweating',priority:'Critical',status:'Doctor',doctor:'Dr. Patel',notes:'',labNeeded:false,prescription:'',labResult:'',dispensed:false,timestamp:Date.now()-3600000},
  {id:1002,name:'Priya Mehta',age:32,symptoms:'High fever (104¬∞F), severe headache, stiff neck',priority:'High',status:'Lab',doctor:'Dr. Sharma',notes:'Suspected meningitis - urgent CT',labNeeded:true,prescription:'',labResult:'',dispensed:false,timestamp:Date.now()-2400000},
  {id:1003,name:'Rajesh Verma',age:60,symptoms:'Dizziness, blurred vision, confusion',priority:'High',status:'Prescription',doctor:'Dr. Rao',notes:'Possible TIA - need imaging',labNeeded:false,prescription:'Aspirin 75mg, Atorvastatin 20mg',labResult:'',dispensed:false,timestamp:Date.now()-1800000},
  {id:1004,name:'Sneha Iyer',age:28,symptoms:'Mild cold, sore throat, runny nose',priority:'Low',status:'Discharged',doctor:'Dr. Sharma',notes:'Viral URTI - symptomatic treatment',labNeeded:false,prescription:'Paracetamol 500mg, Cetirizine 10mg',labResult:'NAD',dispensed:true,timestamp:Date.now()-900000},
];

function init(){
  patients = [...demoPatients];
  patientIdCounter = 1005;
}

// ==================== LOGIN ====================
function selectRole(el){
  document.querySelectorAll('.role-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  currentRole = el.dataset.role;
}
function doLogin(){
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('app').style.display='block';
  document.getElementById('userBadge').textContent = ROLES[currentRole].label;
  // Show correct page
  const defaultPage = ROLES[currentRole].pages[0];
  showPage(defaultPage);
  // Lock nav tabs to role
  restrictNav();
  updateStats();
  showToast('success','‚úÖ','Welcome to MediFlow! System online.');
}
function doLogout(){
  document.getElementById('loginScreen').style.display='flex';
  document.getElementById('app').style.display='none';
}
function restrictNav(){
  document.querySelectorAll('.nav-tab').forEach(tab=>{
    const page = tab.dataset.page;
    const allowed = ROLES[currentRole].pages;
    if(!allowed.includes(page)){
      tab.style.opacity='0.3';
      tab.style.pointerEvents='none';
    } else {
      tab.style.opacity='1';
      tab.style.pointerEvents='auto';
    }
  });
}

// ==================== NAVIGATION ====================
function showPage(name){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t=>t.classList.remove('active'));
  const p = document.getElementById('page-'+name);
  if(p){p.classList.add('active');}
  const t = document.querySelector(`[data-page="${name}"]`);
  if(t){t.classList.add('active');}
  // Render page content
  if(name==='doctor') renderDoctorCards();
  if(name==='lab') renderLabCards();
  if(name==='medical') renderMedicalCards();
  if(name==='tracking') renderTracking();
}

// ==================== AI PRIORITY SUGGESTION ====================
const symptomKeywords = {
  Critical: ['chest pain','heart attack','unconscious','stroke','severe bleeding','can\'t breathe','no pulse'],
  High: ['high fever','headache','vomiting','dizziness','confusion','infection','breathing'],
  Medium: ['fever','pain','nausea','swelling','cough'],
  Low: ['cold','sore throat','mild','runny'],
};
document.getElementById('f-symptoms').addEventListener('input', function(){
  const text = this.value.toLowerCase();
  if(text.length < 5){document.getElementById('aiSuggestion').style.display='none';return;}
  let suggested = 'Low';
  for(const [level,kws] of Object.entries(symptomKeywords)){
    if(kws.some(k=>text.includes(k))){suggested=level;break;}
  }
  const el = document.getElementById('aiSuggestion');
  el.style.display='flex';
  const colors = {Critical:'#fca5a5',High:'#fcd34d',Medium:'#7dd3fc',Low:'#6ee7b7'};
  el.style.color = colors[suggested]||'#a78bfa';
  document.getElementById('aiSuggestionText').textContent = `ü§ñ AI Suggestion: Priority "${suggested}" detected based on symptoms`;
  document.getElementById('f-priority').value = suggested;
});

// ==================== RECEPTION SUBMIT ====================
function submitPatient(){
  const name = document.getElementById('f-name').value.trim();
  const age = document.getElementById('f-age').value.trim();
  const symptoms = document.getElementById('f-symptoms').value.trim();
  const priority = document.getElementById('f-priority').value;
  const doctor = document.getElementById('f-doctor').value;
  if(!name||!age||!symptoms||!priority){
    showToast('error','‚ö†Ô∏è','Please fill in all required fields.');return;
  }
  const patient = {
    id: patientIdCounter++,
    name,age:parseInt(age),symptoms,priority,
    status:'Doctor',doctor,
    notes:'',labNeeded:false,prescription:'',labResult:'',dispensed:false,
    timestamp:Date.now()
  };
  patients.unshift(patient);
  // Clear form
  ['f-name','f-age','f-symptoms'].forEach(id=>document.getElementById(id).value='');
  document.getElementById('f-priority').value='';
  document.getElementById('aiSuggestion').style.display='none';
  updateStats();
  showToast('success','‚úÖ',`Patient ${name} registered! Priority: ${priority}`);
}

// ==================== STATS ====================
function updateStats(){
  const total = patients.length;
  const waiting = patients.filter(p=>p.status==='Doctor').length;
  const critical = patients.filter(p=>p.priority==='Critical').length;
  const done = patients.filter(p=>p.status==='Discharged').length;
  document.getElementById('st-total').textContent=total;
  document.getElementById('st-waiting').textContent=waiting;
  document.getElementById('st-critical').textContent=critical;
  document.getElementById('st-done').textContent=done;
}

// ==================== DOCTOR PAGE ====================
function setDoctorFilter(f,el){
  doctorFilter=f;
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  renderDoctorCards();
}
function renderDoctorCards(){
  const container = document.getElementById('doctorCards');
  const search = document.getElementById('doctorSearch').value.toLowerCase();
  let filtered = patients.filter(p=>{
    const matchSearch = p.name.toLowerCase().includes(search)||p.symptoms.toLowerCase().includes(search);
    const matchFilter = doctorFilter==='all'||p.priority===doctorFilter;
    return matchSearch && matchFilter;
  });
  if(!filtered.length){
    container.innerHTML=`<div class="empty-state" style="grid-column:1/-1"><div class="icon">üîç</div><h3>No patients found</h3><p>Adjust filters or register new patients.</p></div>`;
    return;
  }
  container.innerHTML = filtered.map(p => `
    <div class="patient-card" id="dc-${p.id}">
      <div class="card-header">
        <div class="card-header-left">
          <div class="card-avatar">üë§</div>
          <div>
            <div class="card-name">${p.name}</div>
            <div class="card-meta">ID#${p.id} ¬∑ Age ${p.age} ¬∑ ${p.doctor}</div>
          </div>
        </div>
        <span class="badge badge-${p.priority.toLowerCase()}">${p.priority}</span>
      </div>
      <div class="card-body">
        <div class="card-label">Symptoms</div>
        <div class="card-symptoms">${p.symptoms}</div>
        <div class="card-row">
          <span class="card-label">Status</span>
          <span class="badge badge-${statusClass(p.status)}">${p.status}</span>
        </div>
      </div>
      <div class="card-footer">
        <div class="form-group">
          <label style="font-size:11px;font-family:var(--font-mono);color:var(--cyan);letter-spacing:2px;text-transform:uppercase;">Doctor Notes</label>
          <input class="form-input" type="text" id="notes-${p.id}" value="${p.notes}" placeholder="Clinical observations...">
        </div>
        <div class="toggle-row">
          <span class="toggle-label">Lab Test Required?</span>
          <label class="toggle"><input type="checkbox" id="lab-${p.id}" ${p.labNeeded?'checked':''} onchange="updateLab(${p.id})"><span class="toggle-slider"></span></label>
        </div>
        <div class="form-group">
          <label style="font-size:11px;font-family:var(--font-mono);color:var(--cyan);letter-spacing:2px;text-transform:uppercase;">Prescription</label>
          <input class="form-input" type="text" id="rx-${p.id}" value="${p.prescription}" placeholder="Medicine, dosage...">
        </div>
        <button class="action-btn" onclick="verifyAndSend(${p.id})">‚úÖ Verify & Send</button>
      </div>
    </div>
  `).join('');
}
function statusClass(s){
  const m={Doctor:'inprogress',Lab:'lab',Prescription:'medium',Dispensed:'low',Discharged:'done',Waiting:'waiting'};
  return m[s]||'waiting';
}
function updateLab(id){
  const p = patients.find(x=>x.id===id);
  if(p) p.labNeeded = document.getElementById(`lab-${id}`).checked;
}
function verifyAndSend(id){
  const p = patients.find(x=>x.id===id);
  if(!p)return;
  p.notes = document.getElementById(`notes-${id}`).value;
  p.prescription = document.getElementById(`rx-${id}`).value;
  p.labNeeded = document.getElementById(`lab-${id}`).checked;
  if(p.labNeeded){
    p.status = 'Lab';
    showToast('success','üî¨',`${p.name} sent to Lab for testing.`);
  } else if(p.prescription){
    p.status = 'Prescription';
    showToast('success','üíä',`${p.name} prescription ready for pharmacy.`);
  } else {
    p.status = 'Waiting';
    showToast('success','‚úÖ',`${p.name} record updated.`);
  }
  updateStats();
  renderDoctorCards();
}

// ==================== LAB PAGE ====================
function renderLabCards(){
  const container = document.getElementById('labCards');
  const labPts = patients.filter(p=>p.status==='Lab'||p.labResult);
  if(!labPts.length){
    container.innerHTML=`<div class="empty-state" style="grid-column:1/-1"><div class="icon">üî¨</div><h3>No lab requests</h3><p>Patients sent to lab will appear here.</p></div>`;
    return;
  }
  container.innerHTML = labPts.map(p=>`
    <div class="patient-card">
      <div class="card-header">
        <div class="card-header-left">
          <div class="card-avatar">üß™</div>
          <div>
            <div class="card-name">${p.name}</div>
            <div class="card-meta">ID#${p.id} ¬∑ Age ${p.age}</div>
          </div>
        </div>
        <span class="badge badge-${p.priority.toLowerCase()}">${p.priority}</span>
      </div>
      <div class="card-body">
        <div class="card-row">
          <span class="card-label">Test Required</span>
          <span class="card-value" style="color:var(--cyan);">üî¨ Diagnostic Panel</span>
        </div>
        <div class="card-row">
          <span class="card-label">Doctor Notes</span>
          <span class="card-value" style="font-size:12px;color:var(--text-dim);">${p.notes||'‚Äî'}</span>
        </div>
        <div class="card-symptoms">${p.symptoms}</div>
      </div>
      <div class="card-footer">
        <div class="form-group">
          <label style="font-size:11px;font-family:var(--font-mono);color:var(--cyan);letter-spacing:2px;text-transform:uppercase;">Lab Result</label>
          <input class="form-input" type="text" id="lres-${p.id}" value="${p.labResult}" placeholder="Enter test results...">
        </div>
        <button class="action-btn" onclick="submitLabResult(${p.id})" ${p.labResult?'style="background:rgba(16,185,129,0.2);color:var(--green);border:1px solid rgba(16,185,129,0.3);"':''}>
          ${p.labResult?'‚úÖ Result Submitted':'üì§ Submit Result'}
        </button>
      </div>
    </div>
  `).join('');
}
function submitLabResult(id){
  const p = patients.find(x=>x.id===id);
  if(!p)return;
  const result = document.getElementById(`lres-${id}`).value.trim();
  if(!result){showToast('error','‚ö†Ô∏è','Please enter lab result.');return;}
  p.labResult = result;
  p.status = 'Prescription';
  updateStats();
  renderLabCards();
  showToast('success','üî¨',`Lab result for ${p.name} submitted!`);
}

// ==================== MEDICAL PAGE ====================
function renderMedicalCards(){
  const container = document.getElementById('medicalCards');
  const medPts = patients.filter(p=>p.status==='Prescription'||p.status==='Dispensed'||p.dispensed);
  if(!medPts.length){
    container.innerHTML=`<div class="empty-state" style="grid-column:1/-1"><div class="icon">üíä</div><h3>No prescriptions pending</h3><p>Verified patients with prescriptions appear here.</p></div>`;
    return;
  }
  container.innerHTML = medPts.map(p=>`
    <div class="pharma-card">
      <div class="pharma-header">
        <div>
          <div style="font-family:var(--font-display);font-size:18px;font-weight:700;margin-bottom:4px;">${p.name}</div>
          <div style="font-size:12px;color:var(--text-dim);font-family:var(--font-mono);">ID#${p.id} ¬∑ Age ${p.age} ¬∑ ${p.doctor}</div>
        </div>
        <span class="badge badge-${p.priority.toLowerCase()}">${p.priority}</span>
      </div>
      <div class="card-label" style="margin-bottom:10px;">Prescription</div>
      <div class="rx-list">
        ${p.prescription ? p.prescription.split(',').map(rx=>`
          <div class="rx-item"><span class="rx-icon">üíä</span>${rx.trim()}</div>
        `).join('') : `<div class="rx-item" style="color:var(--text-dim);">No prescription recorded</div>`}
      </div>
      ${p.labResult?`
        <div style="margin-top:12px;">
          <div class="card-label" style="margin-bottom:6px;">Lab Result</div>
          <div class="card-symptoms">${p.labResult}</div>
        </div>
      `:''}
      <button class="dispensed-btn" onclick="dispense(${p.id})" ${p.dispensed?'disabled':''}>
        ${p.dispensed?'‚úÖ Dispensed':'üíä Dispense & Discharge'}
      </button>
    </div>
  `).join('');
}
function dispense(id){
  const p = patients.find(x=>x.id===id);
  if(!p)return;
  p.dispensed = true;
  p.status = 'Discharged';
  updateStats();
  renderMedicalCards();
  showToast('success','üíä',`${p.name} has been discharged!`);
}

// ==================== TRACKING PAGE ====================
const STAGES = ['Reception','Doctor','Lab','Prescription','Discharged'];
const STAGE_ICONS = {Reception:'üè•',Doctor:'üë®‚Äç‚öïÔ∏è',Lab:'üî¨',Prescription:'üíä',Discharged:'üè†'};
const STATUS_STAGE = {
  'Doctor':1, 'Lab':2, 'Prescription':3, 'Dispensed':3, 'Discharged':4, 'Waiting':0
};

function renderTracking(){
  // Stats
  const total = patients.length;
  const active = patients.filter(p=>p.status!=='Discharged').length;
  const inLab = patients.filter(p=>p.status==='Lab').length;
  const complete = patients.filter(p=>p.status==='Discharged').length;
  document.getElementById('tr-total').textContent=total;
  document.getElementById('tr-active').textContent=active;
  document.getElementById('tr-lab').textContent=inLab;
  document.getElementById('tr-complete').textContent=complete;

  // Kanban
  renderKanban();
  // Chart
  renderChart();
  // Timeline
  renderTimeline();
}

function renderKanban(){
  const statuses = ['Doctor','Lab','Prescription','Discharged'];
  const labels = {Doctor:'üë®‚Äç‚öïÔ∏è Doctor',Lab:'üî¨ Lab',Prescription:'üíä Pharmacy',Discharged:'üè† Discharged'};
  const kb = document.getElementById('kanbanBoard');
  kb.innerHTML = statuses.map(s=>{
    const pts = patients.filter(p=>p.status===s);
    return `
      <div class="kanban-col">
        <div class="kanban-title">
          ${labels[s]}
          <span class="kanban-count">${pts.length}</span>
        </div>
        ${pts.length?pts.map(p=>`
          <div class="kanban-card">
            <div class="kanban-card-name">${p.name}</div>
            <div class="kanban-card-meta">${p.priority} ¬∑ Age ${p.age}</div>
          </div>
        `).join(''):`<div style="text-align:center;color:var(--text-muted);font-size:12px;padding:20px;">Empty</div>`}
      </div>
    `;
  }).join('');
}

function renderChart(){
  const days = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
  const vals = [8,13,7,17,11,5,patients.length];
  const max = Math.max(...vals);
  document.getElementById('barChart').innerHTML = days.map((d,i)=>`
    <div class="bar-group">
      <div class="bar" data-val="${vals[i]}" style="height:${(vals[i]/max*120)+4}px;${i===6?'background:linear-gradient(180deg,#fcd34d,#f59e0b);':''}" title="${vals[i]}"></div>
      <div class="bar-label">${d}</div>
    </div>
  `).join('');
}

function renderTimeline(){
  const container = document.getElementById('timelineContainer');
  if(!patients.length){
    container.innerHTML=`<div class="empty-state"><div class="icon">üì°</div><h3>No patients to track</h3><p>Registered patients will appear here.</p></div>`;
    return;
  }
  const stageIdx = {Doctor:1,Lab:2,Prescription:3,Dispensed:3,Discharged:4,Waiting:0};
  container.innerHTML = patients.map(p=>{
    const currentIdx = stageIdx[p.status]??0;
    return `
      <div class="timeline-item">
        <div class="timeline-header">
          <div class="timeline-avatar">${p.priority==='Critical'?'üö®':'üë§'}</div>
          <div class="timeline-info">
            <div class="timeline-name">${p.name}</div>
            <div class="timeline-sub">ID#${p.id} ¬∑ ${p.doctor} ¬∑ ${timeAgo(p.timestamp)}</div>
          </div>
          <span class="badge badge-${p.priority.toLowerCase()}">${p.priority}</span>
          <span class="badge badge-${statusClass(p.status)}" style="margin-left:8px;">${p.status}</span>
        </div>
        <div class="journey">
          ${STAGES.map((s,i)=>{
            let cls='';
            if(i<currentIdx) cls='done';
            else if(i===currentIdx) cls='current';
            return `
              <div class="journey-step ${cls}">
                <div class="journey-dot">${STAGE_ICONS[s]}</div>
                <div class="journey-label">${s}</div>
              </div>
            `;
          }).join('')}
        </div>
      </div>
    `;
  }).join('');
}

function timeAgo(ts){
  const diff = Math.floor((Date.now()-ts)/60000);
  if(diff<1)return'Just now';
  if(diff<60)return`${diff}m ago`;
  return`${Math.floor(diff/60)}h ago`;
}

// ==================== TOAST ====================
function showToast(type, icon, msg){
  const container = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.className=`toast ${type}`;
  toast.innerHTML=`<span class="toast-icon">${icon}</span><span>${msg}</span>`;
  container.appendChild(toast);
  setTimeout(()=>toast.remove(),3100);
}

// ==================== BOOT ====================
init();
</script>
</body>
</html>